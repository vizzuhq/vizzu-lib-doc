class t extends Error{constructor(t,e){const s=new e.ExceptionInfo(t).get_type(),n=e._vizzu_errorMessage(t,s);super("error: "+e.UTF8ToString(n)),this.name="CError"}}class e{constructor(t,e){this.tt=t,this.et=e}st(t){const e=4*t.length+1,s=this.tt._malloc(e);return this.tt.stringToUTF8(t,s,e),s}nt(t){return this.tt.UTF8ToString(t)}rt(t){return this.et.get(this.it(t))}it(e){return(...s)=>{try{return e(...s)}catch(e){throw"number"==typeof e&&Number.isInteger(e)?new t(e,this.tt):e}}}cObjectParams(){return[this.tt,this.et]}}class s extends e{constructor(t,e){super(...e.cObjectParams()),this.getId=t}ot(t){return this.et.get(this.ht(t))}ht(t){return super.it(t).bind(this,this.getId())}}class n extends s{}class r extends s{setParam(t,e=""){const s=this.st(t),n=this.st(e);try{this.ht(this.tt._anim_control_setValue)(s,n)}finally{this.tt._free(n),this.tt._free(s)}}getParam(t){const e=this.st(t);try{const t=this.ht(this.tt._anim_control_getValue)(e);return this.nt(t)}finally{this.tt._free(e)}}storeAnim(){return new n(this.ot(this.tt._chart_anim_store),this)}}class i extends s{constructor(t,e,s){super((()=>e),t),this.stops=this.lt(s)}lt(t){const e=[],s=this.getId();for(let n=0;n<40*t;n+=40)e.push({offset:this.tt.getValue(s+n,"double"),color:"rgba("+255*this.tt.getValue(s+n+8,"double")+","+255*this.tt.getValue(s+n+16,"double")+","+255*this.tt.getValue(s+n+24,"double")+","+this.tt.getValue(s+n+32,"double")+")"});return e}}class a extends s{constructor(t,e){super(e,t)}getColorGradient(t,e){return new i(this,t,e)}getString(t){return this.tt.UTF8ToString(t)}}function o(t,e){if(null===t||"object"!=typeof t)return t;if(t instanceof Function)return t;if(Array.isArray(t)&&t instanceof Array)return t.map((t=>o(t,e)));if(e&&t instanceof e)return t;const s={};for(const n in t)n in t&&(s[n]=o(t[n],e));return s}function h(t){return"object"==typeof t&&null!==t}function l(t,e,s=h,n=""){t&&null!==t&&"object"==typeof t&&Object.keys(t).forEach((r=>{const i=n+(0===n.length?"":".")+r,a=t[r];s(a)?l(a,e,s,i):e(i,a)}))}function c(t,e,s){const n=e.split(".");let r=t;n.forEach(((t,e)=>{if(!function(t){return"object"==typeof t&&null!==t}(r))throw new Error("Expected an object, but got "+typeof r);e<n.length-1?(r[t]=r[t]||("number"==typeof n[e+1]?[]:{}),r=r[t]):r[t]=s}))}class u extends s{constructor(t,e,s,n,r,i,a,o){super(t,e),this.ct=s,this.ut=n,this.dt=r,this.ft=i||h,this.yt=a||(t=>String(t).toString()),this.gt=o||((t,e)=>e)}set(t){l(t,this.setParam.bind(this),this.ft)}get(){return function(t,e){const s=t(),n={};for(const t of s)c(n,t,e(t));return Object.freeze(n)}(this.listParams.bind(this),this.getParam.bind(this))}listParams(){const t=this.ht(this.ct)(),e=this.nt(t);return JSON.parse(e)}getParam(t){const e=this.st(t);try{const s=this.ht(this.ut)(e),n=this.nt(s);return this.gt(t,n)}finally{this.tt._free(e)}}setParam(t,e){const s=this.st(t),n=this.st(this.yt(e));try{this.ht(this.dt)(s,n)}finally{this.tt._free(n),this.tt._free(s)}}}class d extends s{}class m extends s{preventDefault(){this.ht(this.tt._event_preventDefault)()}}class f extends u{}class y extends u{}class p extends u{}class g extends s{constructor(t,e){super(e,t),this.config=this.wt(),this.style=this.vt(!1),this.computedStyle=this.vt(!0),this.animOptions=this.bt()}update(t){this.ht(this.tt._vizzu_update)(t)}render(t,e,s){this._t=t,this.ht(this.tt._vizzu_render)(t.getId(),e,s)}animate(t){const e=this.tt.addFunction((s=>{t(s),this.tt.removeFunction(e)}),"vi");this.ht(this.tt._chart_animate)(e)}storeSnapshot(){return new d(this.ot(this.tt._chart_store),this)}restoreSnapshot(t){this.ht(this.tt._chart_restore)(t.getId())}restoreAnim(t){this.ht(this.tt._chart_anim_restore)(t.getId())}setKeyframe(){this.ht(this.tt._chart_setKeyframe)()}addEventListener(t,e){const s=this.tt.addFunction(((t,s)=>{const n=new m((()=>t),this);e(n,JSON.parse(this.nt(s)))}),"vii"),n=this.st(t);try{this.ht(this.tt._addEventListener)(n,s)}finally{this.tt._free(n)}return s}removeEventListener(t,e){const s=this.st(t);try{this.ht(this.tt._removeEventListener)(s,e)}finally{this.tt._free(s)}this.tt.removeFunction(e)}pointerdown(t,e,s){this._t&&this.ht(this.tt._vizzu_pointerDown)(this._t.getId(),t,e,s)}pointermove(t,e,s){this._t&&this.ht(this.tt._vizzu_pointerMove)(this._t.getId(),t,e,s)}pointerup(t,e,s){this._t&&this.ht(this.tt._vizzu_pointerUp)(this._t.getId(),t,e,s)}pointerleave(t){this._t&&this.ht(this.tt._vizzu_pointerLeave)(this._t.getId(),t)}wheel(t){this._t&&this.ht(this.tt._vizzu_wheel)(this._t.getId(),t)}getString(t){return this.tt.UTF8ToString(t)}wt(){return new f(this.getId,this,this.tt._chart_getList,this.tt._chart_getValue,this.tt._chart_setValue,(t=>h(t)&&!this.xt(t)),(t=>this.xt(t)?t.aggregator?`${t.aggregator}(${t.name})`:t.name:String(t).toString()),((t,e)=>t.startsWith("channels.")&&t.endsWith(".set")?JSON.parse(e).map((t=>this.At(t))):e))}At(t){const e=t.match(/^(\w+)\((.*?)\)$/);return e?{name:e[2],aggregator:e[1]}:{name:t}}xt(t){return"object"==typeof t&&null!==t&&"name"in t}vt(t){return new y(this.getId,this,this.tt._style_getList,((e,s)=>this.tt._style_getValue(e,s,t)),this.tt._style_setValue)}bt(){return new p(this.getId,this,(()=>0),(()=>0),this.tt._anim_setValue)}}class w extends s{toCanvasCoords(t){const e=this.ht(this.tt._chart_relToCanvasCoords)(t.x,t.y);return this.kt(e)}toRelCoords(t){const e=this.ht(this.tt._chart_canvasToRelCoords)(t.x,t.y);return this.kt(e)}kt(t){return{x:this.tt.getValue(t,"double"),y:this.tt.getValue(t+8,"double")}}}class v extends s{constructor(t,e){super((()=>e),t)}getValue(t){const e=this.st(t);let s,n;try{s=this.ht(this.tt._record_getValue)(e),n=this.tt.getValue(s,"i1")?this.nt(this.tt.getValue(s+8,"i8*")):this.tt.getValue(s+8,"double")}finally{this.tt._free(e)}return n}}class b extends s{getMetaInfo(){const t=this.ht(this.tt._data_metaInfo)(),e=this.nt(t);return{series:JSON.parse(e)}}addDimension(t,e,s){const n=new Uint32Array(s.length);for(let t=0;t<s.length;t++){const e=this.st(s[t]);n[t]=e}const r=4*s.length,i=this.tt._malloc(r);new Uint8Array(this.tt.HEAPU8.buffer,i,r).set(new Uint8Array(n.buffer));const a=4*e.length,o=this.tt._malloc(a);new Uint8Array(this.tt.HEAPU8.buffer,o,a).set(new Uint8Array(new Uint32Array(e).buffer));const h=this.st(t);try{this.ht(this.tt._data_addDimension)(h,i,s.length,o,e.length)}finally{this.tt._free(h);for(const t of n)this.tt._free(t);this.tt._free(o),this.tt._free(i)}}addMeasure(t,e,s){const n=new Float64Array(s),r=8*s.length,i=this.tt._malloc(r);new Uint8Array(this.tt.HEAPU8.buffer,i,r).set(new Uint8Array(n.buffer));const a=this.st(t),o=this.st(e);try{this.ht(this.tt._data_addMeasure)(a,o,i,s.length)}finally{this.tt._free(a),this.tt._free(o),this.tt._free(i)}}addRecord(t){const e=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const n=this.st(String(t[s]).toString());e[s]=n}const s=4*t.length,n=this.tt._malloc(s);new Uint8Array(this.tt.HEAPU8.buffer,n,s).set(new Uint8Array(e.buffer));try{this.ht(this.tt._data_addRecord)(n,t.length)}finally{for(const t of e)this.tt._free(t);this.tt._free(n)}}setFilter(t){const e=[0,0];if(null!==t){const s=e=>t(new v(this,e));e[0]=this.tt.addFunction(s,"ii");const n=t=>{t!==e[0]&&console.warn("Wrong pointer passed to destructor"),this.tt.removeFunction(e[0]),this.tt.removeFunction(e[1])};e[1]=this.tt.addFunction(n,"vi")}this.ht(this.tt._chart_setFilter)(...e)}}class _{setFont(t){this.canvas&&this.setFontStyle(this.canvas.getString(t))}text(t,e,s,n,r){this.canvas&&this.drawText(t,e,s,n,this.canvas.getString(r))}setBrushGradient(t,e,s,n,r,i){this.canvas&&this.setGradient(t,e,s,n,this.canvas.getColorGradient(i,r))}}class x{constructor(t){this.St=new FinalizationRegistry((e=>{t(e)}))}get(t){const e=t(),s=()=>e;return this.St.register(s,e),s}}class A extends e{constructor(t){super(t,new x(t._object_free));const e=document.createElement("canvas").getContext("2d");if(!e)throw new Error("Failed to get 2D context");this.tt.measureCanvas=e,this.tt.canvases={},this.tt.charts={},this.setLogging(!1)}registerChart(t,e){this.tt.charts[t.getId()]=e}unregisterChart(t){delete this.tt.charts[t.getId()]}registerRenderer(t,e){this.tt.canvases[t.getId()]=e}unregisterRenderer(t){delete this.tt.canvases[t.getId()]}version(){return this.tt.UTF8ToString(this.tt._vizzu_version())}setLogging(t){this.it(this.tt._vizzu_setLogging)(t)}getData(t){return new b(t.getId,this)}getCoordSystem(t){return new w(t.getId,this)}getAnimControl(t){return new r(t.getId,this)}createChart(){return new g(this,this.rt(this.tt._vizzu_createChart))}createCanvas(){return new a(this,this.rt(this.tt._vizzu_createCanvas))}}var k,S=(k=import.meta.url,function(t={}){var e,s,n=t;n.ready=new Promise(((t,n)=>{e=t,s=n}));var r=Object.assign({},n),i="";"undefined"!=typeof document&&document.currentScript&&(i=document.currentScript.src),k&&(i=k),i=0!==i.indexOf("blob:")?i.substr(0,i.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var a,o,h=console.log.bind(console),l=console.error.bind(console);Object.assign(n,r),r=null,"object"!=typeof WebAssembly&&C("no native wasm support detected");var c,u,d,m,f,y,p,g,w=!1;function v(){var t=o.buffer;n.HEAP8=c=new Int8Array(t),n.HEAP16=d=new Int16Array(t),n.HEAPU8=u=new Uint8Array(t),n.HEAPU16=m=new Uint16Array(t),n.HEAP32=f=new Int32Array(t),n.HEAPU32=y=new Uint32Array(t),n.HEAPF32=p=new Float32Array(t),n.HEAPF64=g=new Float64Array(t)}var b=[],_=[],x=[],A=0,S=null;function C(t){l(t="Aborted("+t+")"),w=!0,t+=". Build with -sASSERTIONS for more info.";var e=new WebAssembly.RuntimeError(t);throw s(e),e}var E,B,j=t=>t.startsWith("data:application/octet-stream;base64,");function P(t){if(t==E&&a)return new Uint8Array(a);throw"both async and sync fetching of the wasm failed"}function T(t,e,s){return function(t){return"function"==typeof fetch?fetch(t,{credentials:"same-origin"}).then((e=>{if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()})).catch((()=>P(t))):Promise.resolve().then((()=>P(t)))}(t).then((t=>WebAssembly.instantiate(t,e))).then((t=>t)).then(s,(t=>{l(`failed to asynchronously prepare wasm: ${t}`),C(t)}))}n.locateFile?j(E="cvizzu.wasm")||(B=E,E=n.locateFile?n.locateFile(B,i):i+B):E=new URL("cvizzu.wasm",import.meta.url).href;var z=t=>{for(;t.length>0;)t.shift()(n)};function O(t,e,s="i8"){switch(s.endsWith("*")&&(s="*"),s){case"i1":case"i8":c[0|t]=e;break;case"i16":d[t>>1]=e;break;case"i32":f[t>>2]=e;break;case"i64":C("to do setValue(i64) use WASM_BIGINT");case"float":p[t>>2]=e;break;case"double":g[t>>3]=e;break;case"*":y[t>>2]=e;break;default:C(`invalid type for setValue: ${s}`)}}function D(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(t){y[this.ptr+4>>2]=t},this.get_type=function(){return y[this.ptr+4>>2]},this.set_destructor=function(t){y[this.ptr+8>>2]=t},this.get_destructor=function(){return y[this.ptr+8>>2]},this.set_caught=function(t){t=t?1:0,c[this.ptr+12|0]=t},this.get_caught=function(){return 0!=c[this.ptr+12|0]},this.set_rethrown=function(t){t=t?1:0,c[this.ptr+13|0]=t},this.get_rethrown=function(){return 0!=c[this.ptr+13|0]},this.init=function(t,e){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(e)},this.set_adjusted_ptr=function(t){y[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return y[this.ptr+16>>2]},this.get_exception_ptr=function(){if(At(this.get_type()))return y[this.excPtr>>2];var t=this.get_adjusted_ptr();return 0!==t?t:this.excPtr}}var W,F,U=t=>{for(var e="",s=t;u[s];)e+=W[u[s++]];return e},I={},M={},N=t=>{throw new F(t)};function R(t,e,s={}){if(!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");return function(t,e,s={}){var n=e.name;if(t||N(`type "${n}" must have a positive integer typeid pointer`),M.hasOwnProperty(t)){if(s.ignoreDuplicateRegistrations)return;N(`Cannot register type '${n}' twice`)}if(M[t]=e,I.hasOwnProperty(t)){var r=I[t];delete I[t],r.forEach((t=>t()))}}(t,e,s)}function $(){this.allocated=[void 0],this.freelist=[]}var L=new $,V=()=>{for(var t=0,e=L.reserved;e<L.allocated.length;++e)void 0!==L.allocated[e]&&++t;return t},H=t=>(t||N("Cannot use deleted val. handle = "+t),L.get(t).value),q=t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return L.allocate({refcount:1,value:t})}};function G(t){return this.fromWireType(f[t>>2])}var K=(t,e)=>{switch(e){case 4:return function(t){return this.fromWireType(p[t>>2])};case 8:return function(t){return this.fromWireType(g[t>>3])};default:throw new TypeError(`invalid float width (${e}): ${t}`)}},J=(t,e,s)=>{switch(e){case 1:return s?t=>c[0|t]:t=>u[0|t];case 2:return s?t=>d[t>>1]:t=>m[t>>1];case 4:return s?t=>f[t>>2]:t=>y[t>>2];default:throw new TypeError(`invalid integer width (${e}): ${t}`)}};function Y(t){return this.fromWireType(y[t>>2])}var Q,X,Z=(t,e,s)=>((t,e,s,n)=>{if(!(n>0))return 0;for(var r=s,i=s+n-1,a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++a)),o<=127){if(s>=i)break;e[s++]=o}else if(o<=2047){if(s+1>=i)break;e[s++]=192|o>>6,e[s++]=128|63&o}else if(o<=65535){if(s+2>=i)break;e[s++]=224|o>>12,e[s++]=128|o>>6&63,e[s++]=128|63&o}else{if(s+3>=i)break;e[s++]=240|o>>18,e[s++]=128|o>>12&63,e[s++]=128|o>>6&63,e[s++]=128|63&o}}return e[s]=0,s-r})(t,u,e,s),tt="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,et=(t,e,s)=>{for(var n=e+s,r=e;t[r]&&!(r>=n);)++r;if(r-e>16&&t.buffer&&tt)return tt.decode(t.subarray(e,r));for(var i="";e<r;){var a=t[e++];if(128&a){var o=63&t[e++];if(192!=(224&a)){var h=63&t[e++];if((a=224==(240&a)?(15&a)<<12|o<<6|h:(7&a)<<18|o<<12|h<<6|63&t[e++])<65536)i+=String.fromCharCode(a);else{var l=a-65536;i+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else i+=String.fromCharCode((31&a)<<6|o)}else i+=String.fromCharCode(a)}return i},st=(t,e)=>t?et(u,t,e):"",nt="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,rt=(t,e)=>{for(var s=t,n=s>>1,r=n+e/2;!(n>=r)&&m[n];)++n;if((s=n<<1)-t>32&&nt)return nt.decode(u.subarray(t,s));for(var i="",a=0;!(a>=e/2);++a){var o=d[t+2*a>>1];if(0==o)break;i+=String.fromCharCode(o)}return i},it=(t,e,s)=>{if(s??=2147483647,s<2)return 0;for(var n=e,r=(s-=2)<2*t.length?s/2:t.length,i=0;i<r;++i){var a=t.charCodeAt(i);d[e>>1]=a,e+=2}return d[e>>1]=0,e-n},at=t=>2*t.length,ot=(t,e)=>{for(var s=0,n="";!(s>=e/4);){var r=f[t+4*s>>2];if(0==r)break;if(++s,r>=65536){var i=r-65536;n+=String.fromCharCode(55296|i>>10,56320|1023&i)}else n+=String.fromCharCode(r)}return n},ht=(t,e,s)=>{if(s??=2147483647,s<4)return 0;for(var n=e,r=n+s-4,i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++i)),f[e>>2]=a,(e+=4)+4>r)break}return f[e>>2]=0,e-n},lt=t=>{for(var e=0,s=0;s<t.length;++s){var n=t.charCodeAt(s);n>=55296&&n<=57343&&++s,e+=4}return e},ct=t=>{var e=(t-o.buffer.byteLength+65535)/65536;try{return o.grow(e),v(),1}catch(t){}},ut=[null,[],[]],dt=(t,e)=>{t<128?e.push(t):e.push(t%128|128,t>>7)},mt=(t,e)=>{if("function"==typeof WebAssembly.Function)return new WebAssembly.Function((t=>{for(var e={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},s={parameters:[],results:"v"==t[0]?[]:[e[t[0]]]},n=1;n<t.length;++n)s.parameters.push(e[t[n]]);return s})(e),t);var s=[1];((t,e)=>{var s=t.slice(0,1),n=t.slice(1),r={i:127,p:127,j:126,f:125,d:124,e:111};e.push(96),dt(n.length,e);for(var i=0;i<n.length;++i)e.push(r[n[i]]);"v"==s?e.push(0):e.push(1,r[s])})(e,s);var n=[0,97,115,109,1,0,0,0,1];dt(s.length,n),n.push.apply(n,s),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var r=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(r,{e:{f:t}}).exports.f},ft=t=>Q.get(t),yt=t=>(X||(X=new WeakMap,((t,e)=>{if(X)for(var s=t;s<t+e;s++){var n=ft(s);n&&X.set(n,s)}})(0,Q.length)),X.get(t)||0),pt=[],gt=(t,e)=>Q.set(t,e);(()=>{for(var t=new Array(256),e=0;e<256;++e)t[e]=String.fromCharCode(e);W=t})(),F=n.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},n.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},Object.assign($.prototype,{get(t){return this.allocated[t]},has(t){return void 0!==this.allocated[t]},allocate(t){var e=this.freelist.pop()||this.allocated.length;return this.allocated[e]=t,e},free(t){this.allocated[t]=void 0,this.freelist.push(t)}}),L.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),L.reserved=L.allocated.length,n.count_emval_handles=V;var wt={a:(t,e,s)=>{throw new D(t).init(e,s),t},m:(t,e,s,n,r)=>{},r:(t,e,s,n)=>{R(t,{name:e=U(e),fromWireType:function(t){return!!t},toWireType:function(t,e){return e?s:n},argPackAdvance:8,readValueFromPointer:function(t){return this.fromWireType(u[t])},destructorFunction:null})},q:(t,e)=>{R(t,{name:e=U(e),fromWireType:t=>{var e=H(t);return(t=>{t>=L.reserved&&0==--L.get(t).refcount&&L.free(t)})(t),e},toWireType:(t,e)=>q(e),argPackAdvance:8,readValueFromPointer:G,destructorFunction:null})},f:(t,e,s)=>{R(t,{name:e=U(e),fromWireType:t=>t,toWireType:(t,e)=>e,argPackAdvance:8,readValueFromPointer:K(e,s),destructorFunction:null})},c:(t,e,s,n,r)=>{e=U(e);var i=t=>t;if(0===n){var a=32-8*s;i=t=>t<<a>>>a}var o=e.includes("unsigned");R(t,{name:e,fromWireType:i,toWireType:o?function(t,e){return this.name,e>>>0}:function(t,e){return this.name,e},argPackAdvance:8,readValueFromPointer:J(e,s,0!==n),destructorFunction:null})},b:(t,e,s)=>{var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];function r(t){var e=y[t>>2],s=y[t+4>>2];return new n(c.buffer,s,e)}R(t,{name:s=U(s),fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{ignoreDuplicateRegistrations:!0})},g:(t,e)=>{var s="std::string"===(e=U(e));R(t,{name:e,fromWireType(t){var e,n=y[t>>2],r=t+4;if(s)for(var i=r,a=0;a<=n;++a){var o=r+a;if(a==n||0==u[o]){var h=st(i,o-i);void 0===e?e=h:(e+=String.fromCharCode(0),e+=h),i=o+1}}else{var l=new Array(n);for(a=0;a<n;++a)l[a]=String.fromCharCode(u[r+a]);e=l.join("")}return xt(t),e},toWireType(t,e){var n;e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r="string"==typeof e;r||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||N("Cannot pass non-string to std::string"),n=s&&r?(t=>{for(var e=0,s=0;s<t.length;++s){var n=t.charCodeAt(s);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++s):e+=3}return e})(e):e.length;var i=_t(4+n+1),a=i+4;if(y[i>>2]=n,s&&r)Z(e,a,n+1);else if(r)for(var o=0;o<n;++o){var h=e.charCodeAt(o);h>255&&(xt(a),N("String has UTF-16 code units that do not fit in 8 bits")),u[a+o]=h}else for(o=0;o<n;++o)u[a+o]=e[o];return null!==t&&t.push(xt,i),i},argPackAdvance:8,readValueFromPointer:Y,destructorFunction(t){xt(t)}})},d:(t,e,s)=>{var n,r,i,a,o;s=U(s),2===e?(n=rt,r=it,a=at,i=()=>m,o=1):4===e&&(n=ot,r=ht,a=lt,i=()=>y,o=2),R(t,{name:s,fromWireType:t=>{for(var s,r=y[t>>2],a=i(),h=t+4,l=0;l<=r;++l){var c=t+4+l*e;if(l==r||0==a[c>>o]){var u=n(h,c-h);void 0===s?s=u:(s+=String.fromCharCode(0),s+=u),h=c+e}}return xt(t),s},toWireType:(t,n)=>{"string"!=typeof n&&N(`Cannot pass non-string to C++ string type ${s}`);var i=a(n),h=_t(4+i+e);return y[h>>2]=i>>o,r(n,h+4,i+e),null!==t&&t.push(xt,h),h},argPackAdvance:8,readValueFromPointer:G,destructorFunction(t){xt(t)}})},s:(t,e)=>{R(t,{isVoid:!0,name:e=U(e),argPackAdvance:0,fromWireType:()=>{},toWireType:(t,e)=>{}})},e:()=>{C("")},H:function(t,e,s,r,i,a,o){n.canvases[t].addBezier(e,s,r,i,a,o)},I:function(t,e,s){n.canvases[t].addPoint(e,s)},O:function(t){n.canvases[t].beginDropShadow()},J:function(t){n.canvases[t].beginPolygon()},D:function(t,e,s,r){n.canvases[t].circle(e,s,r)},K:function(t){n.canvases[t].endDropShadow()},G:function(t){n.canvases[t].endPolygon()},y:function(t){n.canvases[t].frameBegin()},z:function(t){n.canvases[t].frameEnd()},C:function(t,e,s,r,i){n.canvases[t].line(e,s,r,i)},F:function(t,e,s,r,i){n.canvases[t].rectangle(e,s,r,i)},v:function(t){n.canvases[t].restore()},w:function(t){n.canvases[t].save()},k:function(t,e,s,r,i){n.canvases[t].setBrushColor(e,s,r,i)},A:function(t,e,s,r,i,a,o){n.canvases[t].setBrushGradient(e,s,r,i,a,o)},n:function(t,e,s,r){n.canvases[t].setClipCircle(e,s,r)},l:function(t){n.canvases[t].setClipPolygon()},t:function(t,e,s,r,i){n.canvases[t].setClipRect(e,s,r,i)},N:function(t,e){n.canvases[t].setDropShadowBlur(e)},M:function(t,e,s,r,i){n.canvases[t].setDropShadowColor(e,s,r,i)},L:function(t,e,s){n.canvases[t].setDropShadowOffset(e,s)},h:function(t,e){n.canvases[t].setFont(e)},j:function(t,e,s,r,i){n.canvases[t].setLineColor(e,s,r,i)},i:function(t,e){n.canvases[t].setLineWidth(e)},B:function(t,e,s,r,i,a){n.canvases[t].text(e,s,r,i,a)},x:function(t,e,s,r,i,a,o){n.canvases[t].transform(e,s,r,i,a,o)},E:function(t){n.charts[t].doChange()},P:function(t,e){n.charts[t].openUrl(e)},o:t=>{var e=u.length,s=2147483648;if((t>>>=0)>s)return!1;for(var n,r,i=1;i<=4;i*=2){var a=e*(1+.2/i);a=Math.min(a,t+100663296);var o=Math.min(s,(n=Math.max(t,a))+((r=65536)-n%r)%r);if(ct(o))return!0}return!1},p:(t,e,s,n)=>{for(var r,i,a,o=0,c=0;c<s;c++){var d=y[e>>2],m=y[e+4>>2];e+=8;for(var f=0;f<m;f++)r=t,i=u[d+f],a=void 0,a=ut[r],0===i||10===i?((1===r?h:l)(et(a,0)),a.length=0):a.push(i);o+=m}return y[n>>2]=o,0},u:function(t,e,s,r){const i=n.measureCanvas;i.font=st(t);let a=i.measureText(st(e));const o=a.width;a=i.measureText("Op");const h=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;O(s,o,"double"),O(r,h,"double")}},vt=function(){var t,e,n,r;function i(t,e){var s;return vt=t.exports,o=vt.Q,v(),Q=vt.Da,s=vt.R,_.unshift(s),function(t){if(0==--A&&S){var e=S;S=null,e()}}(),vt}return A++,(t=a,e=E,n={a:wt},r=function(t){i(t.instance)},t||"function"!=typeof WebAssembly.instantiateStreaming||j(e)||"function"!=typeof fetch?T(e,n,r):fetch(e,{credentials:"same-origin"}).then((t=>WebAssembly.instantiateStreaming(t,n).then(r,(function(t){return l(`wasm streaming compile failed: ${t}`),l("falling back to ArrayBuffer instantiation"),T(e,n,r)}))))).catch(s),{}}();n._vizzu_errorMessage=(t,e)=>(n._vizzu_errorMessage=vt.S)(t,e),n._vizzu_version=()=>(n._vizzu_version=vt.T)(),n._vizzu_setLogging=t=>(n._vizzu_setLogging=vt.U)(t),n._vizzu_createChart=()=>(n._vizzu_createChart=vt.V)(),n._vizzu_createCanvas=()=>(n._vizzu_createCanvas=vt.W)(),n._vizzu_pointerMove=(t,e,s,r,i)=>(n._vizzu_pointerMove=vt.X)(t,e,s,r,i),n._vizzu_pointerDown=(t,e,s,r,i)=>(n._vizzu_pointerDown=vt.Y)(t,e,s,r,i),n._vizzu_pointerUp=(t,e,s,r,i)=>(n._vizzu_pointerUp=vt.Z)(t,e,s,r,i),n._vizzu_pointerLeave=(t,e,s)=>(n._vizzu_pointerLeave=vt._)(t,e,s),n._vizzu_wheel=(t,e,s)=>(n._vizzu_wheel=vt.$)(t,e,s),n._vizzu_update=(t,e)=>(n._vizzu_update=vt.aa)(t,e),n._vizzu_render=(t,e,s,r)=>(n._vizzu_render=vt.ba)(t,e,s,r),n._style_getList=()=>(n._style_getList=vt.ca)(),n._style_setValue=(t,e,s)=>(n._style_setValue=vt.da)(t,e,s),n._style_getValue=(t,e,s)=>(n._style_getValue=vt.ea)(t,e,s),n._chart_store=t=>(n._chart_store=vt.fa)(t),n._chart_restore=(t,e)=>(n._chart_restore=vt.ga)(t,e),n._chart_anim_store=t=>(n._chart_anim_store=vt.ha)(t),n._chart_anim_restore=(t,e)=>(n._chart_anim_restore=vt.ia)(t,e),n._object_free=t=>(n._object_free=vt.ja)(t),n._chart_getList=()=>(n._chart_getList=vt.ka)(),n._chart_getValue=(t,e)=>(n._chart_getValue=vt.la)(t,e),n._chart_setValue=(t,e,s)=>(n._chart_setValue=vt.ma)(t,e,s),n._chart_setFilter=(t,e,s)=>(n._chart_setFilter=vt.na)(t,e,s),n._record_getValue=(t,e)=>(n._record_getValue=vt.oa)(t,e),n._data_addDimension=(t,e,s,r,i,a)=>(n._data_addDimension=vt.pa)(t,e,s,r,i,a),n._data_addMeasure=(t,e,s,r,i)=>(n._data_addMeasure=vt.qa)(t,e,s,r,i),n._data_addRecord=(t,e,s)=>(n._data_addRecord=vt.ra)(t,e,s),n._data_metaInfo=t=>(n._data_metaInfo=vt.sa)(t),n._addEventListener=(t,e,s)=>(n._addEventListener=vt.ta)(t,e,s),n._removeEventListener=(t,e,s)=>(n._removeEventListener=vt.ua)(t,e,s),n._event_preventDefault=t=>(n._event_preventDefault=vt.va)(t),n._chart_animate=(t,e)=>(n._chart_animate=vt.wa)(t,e),n._chart_relToCanvasCoords=(t,e,s)=>(n._chart_relToCanvasCoords=vt.xa)(t,e,s),n._chart_canvasToRelCoords=(t,e,s)=>(n._chart_canvasToRelCoords=vt.ya)(t,e,s),n._chart_setKeyframe=t=>(n._chart_setKeyframe=vt.za)(t),n._anim_control_setValue=(t,e,s)=>(n._anim_control_setValue=vt.Aa)(t,e,s),n._anim_control_getValue=(t,e)=>(n._anim_control_getValue=vt.Ba)(t,e),n._anim_setValue=(t,e,s)=>(n._anim_setValue=vt.Ca)(t,e,s);var bt,_t=n._malloc=t=>(_t=n._malloc=vt.Ea)(t),xt=n._free=t=>(xt=n._free=vt.Fa)(t),At=t=>(At=vt.Ga)(t);function kt(){A>0||(z(b),A>0||bt||(bt=!0,n.calledRun=!0,w||(z(_),e(n),z(x))))}return n.addFunction=(t,e)=>{var s=yt(t);if(s)return s;var n=(()=>{if(pt.length)return pt.pop();try{Q.grow(1)}catch(t){if(!(t instanceof RangeError))throw t;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return Q.length-1})();try{gt(n,t)}catch(s){if(!(s instanceof TypeError))throw s;var r=mt(t,e);gt(n,r)}return X.set(t,n),n},n.removeFunction=t=>{X.delete(ft(t)),gt(t,null),pt.push(t)},n.setValue=O,n.getValue=function(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return c[0|t];case"i16":return d[t>>1];case"i32":return f[t>>2];case"i64":C("to do getValue(i64) use WASM_BIGINT");case"float":return p[t>>2];case"double":return g[t>>3];case"*":return y[t>>2];default:C(`invalid type for getValue: ${e}`)}},n.UTF8ToString=st,n.stringToUTF8=Z,n.ExceptionInfo=D,S=function t(){bt||kt(),bt||(S=t)},kt(),t.ready});const C=new class{constructor(){this.Ct={},this.Et=null}set options(t){this.Ct={...this.Ct,...t}}get options(){return this.Ct}initialize(){return this.Et||(this.Et=this.Bt()),this.Et}async Bt(){return new A(await S(this.jt()))}jt(){const t={};if(this.Ct?.wasmUrl){const e=this.Ct.wasmUrl;t.locateFile=t=>t.endsWith(".wasm")?e:t}return t}};class E extends Error{constructor(){super("Canvas is not initialized"),this.name="CanvasError"}}class B extends _{constructor(){super(...arguments),this.Pt=!1,this.Tt=1}get hooks(){return{render:(t,e)=>{"htmlCanvas"in t&&(this.zt=t.htmlCanvas,t.renderer=this),e()}}}get Ot(){if(!this.zt)throw new E;return this.zt}get Dt(){if(!this.zt)throw new E;return this.zt.context}frameBegin(){this.Tt=1,this.Pt=!1,this.Ot.frameBegin()}frameEnd(){this.Ot.frameEnd()}setClipRect(t,e,s,n){const r=this.Dt;r.beginPath(),r.rect(t,e,s,n),r.clip()}setClipCircle(t,e,s){const n=this.Dt;n.beginPath(),n.arc(t,e,s,0,6.28318530718),n.clip()}setClipPolygon(){const t=this.Dt;t.closePath(),t.clip(),this.Pt=!1}setBrushColor(t,e,s,n){this.Dt.fillStyle="rgba("+255*t+","+255*e+","+255*s+","+n+")"}setLineColor(t,e,s,n){this.Dt.strokeStyle="rgba("+255*t+","+255*e+","+255*s+","+n+")"}setLineWidth(t){this.Dt.lineWidth=t,this.Tt=t}setFontStyle(t){this.Dt.font=t}beginDropShadow(){}setDropShadowBlur(t){this.Dt.shadowBlur=t}setDropShadowColor(t,e,s,n){this.Dt.shadowColor="rgba("+255*t+","+255*e+","+255*s+","+n+")"}setDropShadowOffset(t,e){const s=this.Dt;s.shadowOffsetX=t,s.shadowOffsetY=e}endDropShadow(){const t=this.Dt;t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor="rgba(0, 0, 0, 0)"}beginPolygon(){this.Dt.beginPath()}addPoint(t,e){const s=this.Dt;this.Pt?s.lineTo(t,e):s.moveTo(t,e),this.Pt=!0}addBezier(t,e,s,n,r,i){this.Dt.bezierCurveTo(t,e,s,n,r,i)}endPolygon(){const t=this.Dt;t.closePath(),t.fill(),0!==this.Tt&&t.stroke(),this.Pt=!1}rectangle(t,e,s,n){const r=this.Dt;r.beginPath(),r.rect(t,e,s,n),r.fill(),0!==this.Tt&&r.stroke()}circle(t,e,s){const n=this.Dt;n.beginPath(),n.arc(t,e,s,0,6.28318530718),n.fill(),0!==this.Tt&&n.stroke()}line(t,e,s,n){const r=this.Dt;r.beginPath(),r.moveTo(t,e),r.lineTo(s,n),0!==this.Tt&&r.stroke()}drawText(t,e,s,n,r){const i=this.Dt;i.textAlign="left",i.textBaseline="top",t+=s<0?-s:0,e+=n<0?-n:0,i.fillText(r,t,e)}setGradient(t,e,s,n,r){const i=this.Dt,a=i.createLinearGradient(t,e,s,n);r.stops.forEach((t=>a.addColorStop(t.offset,t.color))),i.fillStyle=a}transform(t,e,s,n,r,i){this.Dt.transform(t,e,s,n,r,i)}save(){this.Dt.save()}restore(){this.Dt.restore()}}class j{constructor(){this.meta={name:"clock"}}get api(){return{now:()=>this.Wt()}}get hooks(){return{update:(t,e)=>{null===t.timeInMSecs&&(t.timeInMSecs=this.Wt()),e()}}}Wt(){return performance.now()}}class P{constructor(t){this.meta={name:"coordSystem"},this.api={toCanvas:t=>this.Ft.toCanvasCoords(t),toRelative:t=>this.Ft.toRelCoords(t)},this.Ft=t}}const T=t=>{try{return t.cssRules,!0}catch(t){return!1}},z=(t,e="")=>{const s=((t="")=>[...document.styleSheets].filter(T).reduce(((e,s)=>e.concat([...s.cssRules].filter((t=>"CSSStyleRule"===t.constructor.name)).reduce(((e,s)=>[...e,...[...s.style].filter((e=>0===e.trim().indexOf("--"+t+"-"))).map((t=>t.trim()))]),[]))),[]))(e),n=getComputedStyle(t);return s.map((t=>[t,n.getPropertyValue(t).trim()])).filter((t=>""!==t[1]))};class O{constructor(t={}){this.meta={name:"cssProperties",depends:["htmlCanvas"]},this.api={prefix:"vizzu"},t?.prefix&&(this.api.prefix=t.prefix)}get hooks(){return{prepareAnimation:(t,e)=>{const s=z(this.Ut.feature.htmlCanvas.element,this.api.prefix);Array.isArray(t.target)&&t.target.forEach((({target:t})=>{t instanceof d||(t.style=((t,e,s="",n=!1)=>(e=e||{},e=t.reduce(((t,[e,r])=>(e&&((t,e,s,n)=>{e.reduce(((t,r,i)=>(i===e.length-1?!n&&t[r]||(t[r]=s):t[r]||(t[r]={}),t[r])),t)})(t,e.replace("--"+(s?s+"-":""),"").split("-"),r,n),t)),e),e))(s,t.style,this.api.prefix))})),e()}}}register(t){this.Ut=t}}var D;!function(t){t.click="click",t.pointermove="pointermove",t.pointerdown="pointerdown",t.pointerup="pointerup",t.pointerleave="pointerleave",t.wheel="wheel",t.update="update",t.drawBegin="draw-begin",t.drawComplete="draw-complete",t.backgroundDraw="background-draw",t.titleDraw="title-draw",t.subtitleDraw="subtitle-draw",t.captionDraw="caption-draw",t.logoDraw="logo-draw",t.legendBackgroundDraw="legend-background-draw",t.legendTitleDraw="legend-title-draw",t.legendLabelDraw="legend-label-draw",t.legendMarkerDraw="legend-marker-draw",t.legendBarDraw="legend-bar-draw",t.plotBackgroundDraw="plot-background-draw",t.plotAreaDraw="plot-area-draw",t.plotMarkerDraw="plot-marker-draw",t.plotMarkerLabelDraw="plot-marker-label-draw",t.plotMarkerGuideDraw="plot-marker-guide-draw",t.plotAxisDraw="plot-axis-draw",t.plotAxisTitleDraw="plot-axis-title-draw",t.plotAxisLabelDraw="plot-axis-label-draw",t.plotAxisTickDraw="plot-axis-tick-draw",t.plotAxisGuideDraw="plot-axis-guide-draw",t.plotAxisInterlacingDraw="plot-axis-interlacing-draw",t.animationBegin="animation-begin",t.animationComplete="animation-complete"}(D||(D={}));class W{constructor(t){this.It={},this.Mt=t}add(t,e){if("string"!=typeof t)throw new Error("first parameter should be string");this.Nt(t).push(e)}Nt(t){if(!(t in this.It)){let e=null;if(!this.Rt(t)){const s=(e,s)=>{this.$t(t,s,e)};e=this.Mt.addEventListener(t,s)}this.It[t]=[e,[]]}return this.It[t][1]}remove(t,e){if("string"!=typeof t)throw new Error("first parameter should be string");const s=this.It[t];if(!s)throw new Error("unknown event handler");const[n,r]=s;r.find(((t,s)=>t===e&&(r.splice(s,1),!0))),0===r.length&&(this.Rt(t)||n&&this.Mt.removeEventListener(t,n),delete this.It[t])}addMany(t){for(const[e,s]of Object.entries(t))this.add(e,s)}removeMany(t){for(const[e,s]of Object.entries(t))this.remove(e,s)}$t(t,e,s){const n={canceled:!1};try{const r=this.It[t];if(r)for(const i of[...r[1]]){i(this.Rt(t)?this.Lt(e,n):s?this.Vt(s,e,n):e)}}catch(t){console.log("exception in event handler: "+t)}return n.canceled}Rt(t){return t.startsWith("api-")}Lt(t,e){return t.preventDefault=()=>{e.canceled=!0},t}Vt(t,e,s){return e.preventDefault=()=>{t.preventDefault(),s.canceled=!0},e}}var F=Object.freeze({__proto__:null,get EventType(){return D},Events:W});class U{get api(){return{element:this.element,context:this.context,clientToCanvas:this.Ht.bind(this),canvasToClient:this.qt.bind(this)}}get hooks(){return{start:(t,e)=>{this.Gt=t.update,e()},render:(t,e)=>{t.htmlCanvas=this,t.size=this.Kt(),e()}}}get listeners(){return Object.fromEntries(Object.values(D).filter((t=>t.endsWith("-draw")||t.startsWith("draw-"))).map((t=>[t,this.Jt.bind(this)])))}Jt(t){t.renderingContext=this.context}static extractOptions(t){const e="object"!=typeof t||t instanceof HTMLElement?{element:t}:t;if(null===e||!("element"in e))throw new Error("element not specified");let s=e.element;if("string"==typeof s&&(s=document.getElementById(s)),!(s instanceof HTMLElement))throw new Error(`Cannot find element ${e.element} to render Vizzu!`);return{element:s}}constructor(t){this.Gt=()=>{},this.Yt="",this.Qt=1,this.Xt=1,this.Zt=1,this.meta={name:"htmlCanvas"},this.te=this.ee(t.element),this.se=document.createElement("canvas");const e=this.se.getContext("2d");if(!e)throw Error("Cannot get rendering context of internal canvas");this.ne=e;const s=this.te.getContext("2d");if(!s)throw Error("Cannot get rendering context of canvas");this.Dt=s,this.Kt(),this.re=this.ie(this.te),this.ae=()=>{this.Gt(!0)},window.addEventListener("resize",this.ae)}unregister(){window.removeEventListener("resize",this.ae),this.re.disconnect(),this.oe&&this.oe.removeChild(this.te)}get element(){return this.te}get context(){return this.ne}Kt(){this.Qt=window.devicePixelRatio,this.Xt=+getComputedStyle(this.te).width.slice(0,-2),this.Zt=+getComputedStyle(this.te).height.slice(0,-2);const t=`${this.Qt}:${this.Xt}:${this.Zt}`;return t!==this.Yt&&(this.te.width=this.Xt*this.Qt,this.te.height=this.Zt*this.Qt,this.se.width=this.Xt*this.Qt,this.se.height=this.Zt*this.Qt,this.ne.setTransform(1,0,0,1,0,0),this.ne.translate(.5,.5),this.ne.scale(this.Qt,this.Qt)),this.Yt=t,{x:this.Xt,y:this.Zt}}frameBegin(){this.ne.clearRect(-1,-1,this.Xt+2,this.Zt+2)}frameEnd(){this.Dt.clearRect(-1,-1,this.te.width+1,this.te.height+1),this.Dt.drawImage(this.se,0,0)}he(){return this.te.getBoundingClientRect()}le(t){return{x:t.width/(this.te.width/this.Qt),y:t.height/(this.te.height/this.Qt)}}Ht(t){const e=this.he(),s=this.le(e);return{x:(t.x-e.x)/s.x,y:(t.y-e.y)/s.y}}qt(t){const e=this.he(),s=this.le(e);return{x:e.x+t.x*s.x,y:e.y+t.y*s.y}}ee(t){if(t instanceof HTMLCanvasElement)return t;{const e=document.createElement("canvas");return e.style.width="100%",e.style.height="100%",this.oe=t,this.oe.appendChild(e),e}}ie(t){const e=new ResizeObserver((()=>{this.Gt(!0)}));return e.observe(t),e}}class I{constructor(t){this.meta={name:"logging"},this.ce=t}enable(t){this.ce(t)}}const M=(t,e)=>{if(!t)throw new Error("Assert failed: "+e)},N=(t,e,s)=>{M(Array.isArray(e),"array is not a list");try{if(e.length!==t.dimensions[s].values.length)throw new Error("Assert failed")}catch(t){M(!1,"dimensions are not the same")}e.forEach((e=>{Array.isArray(e)&&N(t,e,s-1)}))};class R{static isPivot(t){return void 0!==t&&("dimensions"in t&&void 0!==t.dimensions||"measures"in t&&void 0!==t.measures)}static convert(t){M("object"==typeof t&&null!==t&&!Array.isArray(t),"data is not an object"),M("dimensions"in t,"data.dimensions is requreid"),M("measures"in t,"data.measures is requreid");const e=(({dimensions:t,measures:e,...s})=>Object.assign(s,{series:[]}))(t);let s=1;M(Array.isArray(t.dimensions),"data.dimensions is not a list");for(let e=0;e<t.dimensions.length;e++){const n=t.dimensions[e];M("object"==typeof n&&null!==n&&!Array.isArray(n),"data.dimensions.item is not an object"),M("name"in n,"data.dimensions.item.name is requreid"),M(void 0===n.type||"dimension"===n.type,"data.dimensions.item.type is invalid"),M("values"in n,"data.dimensions.item.values is requreid"),M(Array.isArray(n.values),"data.dimensions.item.values is not a list"),M(0!==n.values.length,"data.dimensions.item.values length is zero"),s*=n.values.length}let n=1;for(let r=0;r<t.dimensions.length;r++){const i=t.dimensions[r];let a=[];const o=[];i.values.forEach((t=>{for(let e=1;e<=n;e++)o.push(t)})),n*=i.values.length;for(let t=1;t<=s/n;t++)a=a.concat(o);const h={name:i.name,type:"dimension",values:a};e.series.push(h)}M("object"==typeof t.measures&&null!==t.measures,"data.measures is not a list or an object"),Array.isArray(t.measures)||(t.measures=[t.measures]);for(let n=0;n<t.measures.length;n++){const r=t.measures[n];M("object"==typeof r&&null!==r&&!Array.isArray(r),"data.measures.item is not an object"),M("name"in r,"data.measures.item.name is requreid"),M("values"in r,"data.measures.item.values is requreid"),M(Array.isArray(r.values),"data.measures.item.values is not a list"),N(t,r.values,t.dimensions.length-1);const i={name:r.name,type:r.type,values:r.values.flat(1/0)};void 0===i.type&&delete i.type,M(i.values.length===s,"dimensions are not the same"),e.series.push(i)}return e}}class ${constructor(){this.meta={name:"pivotData"}}get hooks(){return{prepareAnimation:(t,e)=>{Array.isArray(t.target)&&t.target.forEach((({target:t})=>{if(!(t instanceof d)&&t.data&&t.data&&R.isPivot(t.data)){if($.ue(t.data))throw new Error("inconsistent data form: series/records and dimensions/measures are both set.");t.data=R.convert(t.data)}})),e()}}}static ue(t){return"series"in t||"records"in t}}class L extends Error{constructor(){super("animation canceled"),this.name="CancelError"}}class V extends Error{constructor(){super("vizzu is not initialized, use `initializing` promise"),this.name="NotInitializedError"}}class H{constructor(t){this.de=!1,this.meta={name:"pointerEvents",depends:["htmlCanvas"]},this.me={pointermove:e=>{this.fe(e,t.pointermove.bind(t))},pointerup:e=>{this.fe(e,t.pointerup.bind(t))},pointerdown:e=>{this.fe(e,t.pointerdown.bind(t))},pointerleave:e=>{this.fe(e,t.pointerleave.bind(t))},wheel:e=>{this.fe(e,t.wheel.bind(t),"deltaY")}}}register(t){this.ye=t,this.pe=this.ye?.feature.htmlCanvas}unregister(){this.de&&this.ge()}enable(t){this.de=t,t?this.we():this.ge()}we(){if(!this.ye||!this.me)throw new V;this.Ot=this.ye.feature.htmlCanvas.element;for(const[t,e]of Object.entries(this.me))this.Ot.addEventListener(t,e)}ge(){if(this.me&&this.Ot)for(const[t,e]of Object.entries(this.me))this.Ot.removeEventListener(t,e);delete this.Ot}fe(t,e,s="pointerId"){const n=[t[s]];void 0!==t.clientX&&n.push(...this.ve(t)),e(...n)}ve(t){const e={x:t.clientX,y:t.clientY};if(!this.pe)throw new V;const s=this.pe.clientToCanvas(e);return[s.x,s.y]}}const q={column:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},label:{set:[{name:"y"}]}}},groupedColumn:{channels:{x:{set:[{name:"groupedBy"},{name:"x"}]},y:{set:[{name:"y"}]},label:{set:[{name:"y"}]},color:{set:[{name:"x"}]}}},stackedColumn:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},label:{set:[{name:"y"}]},color:{set:[{name:"stackedBy"}]}}},splittedColumn:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"splittedBy"}]},color:{set:[{name:"splittedBy"}]},label:{set:[{name:"y"}]}},split:!0},percentageColumn:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]},label:{set:[{name:"y"}]}},align:"stretch"},waterfall:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"x"}]},label:{set:[{name:"y"}]},color:{set:[{name:"y"}]}},align:"stretch"},mekko:{channels:{x:{set:[{name:"x"},{name:"groupedBy"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]},label:{set:[{name:"groupedBy"}]}}},marimekko:{channels:{x:{set:[{name:"x"},{name:"groupedBy"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]},label:{set:[{name:"groupedBy"}]}},align:"stretch"},bar:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},label:{set:[{name:"x"}]}}},groupedBar:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"groupedBy"},{name:"y"}]},label:{set:[{name:"x"}]},color:{set:[{name:"y"}]}}},stackedBar:{channels:{x:{set:[{name:"x"},{name:"stackedBy"}]},y:{set:[{name:"y"}]},label:{set:[{name:"x"}]},color:{set:[{name:"stackedBy"}]}}},splittedBar:{channels:{x:{set:[{name:"x"},{name:"splittedBy"}]},y:{set:[{name:"y"}]},color:{set:[{name:"splittedBy"}]},label:{set:[{name:"x"}]}},split:!0},percentageBar:{channels:{x:{set:[{name:"x"},{name:"stackedBy"}]},y:{set:[{name:"y"}]},color:{set:[{name:"stackedBy"}]},label:{set:[{name:"x"}]}},align:"stretch"},lollipop:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},label:{set:[{name:"y"}]}},geometry:"circle"},scatter:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},noop:{set:[{name:"dividedBy"}]}},geometry:"circle"},bubbleplot:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},color:{set:[{name:"color"}]},size:{set:[{name:"size"}]},label:{set:[{name:"dividedBy"}]},noop:{set:[{name:"dividedBy"}]}},geometry:"circle"},area:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]}},geometry:"area"},stackedArea:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]}},geometry:"area"},percentageArea:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]}},align:"stretch",geometry:"area"},splittedArea:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"splittedBy"}]},color:{set:[{name:"splittedBy"}]}},split:!0,geometry:"area"},stream:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]}},geometry:"area",align:"center"},verticalStream:{channels:{x:{set:[{name:"x"},{name:"stackedBy"}]},y:{set:[{name:"y"}]},color:{set:[{name:"stackedBy"}]}},geometry:"area",align:"center"},violin:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"},{name:"splittedBy"}]},color:{set:[{name:"splittedBy"}]}},geometry:"area",align:"center",split:!0},verticalViolin:{channels:{x:{set:[{name:"x"},{name:"splittedBy"}]},y:{set:[{name:"y"}]},color:{set:[{name:"splittedBy"}]}},geometry:"area",align:"center",split:!0},line:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},color:{set:[{name:"dividedBy"}]}},geometry:"line"},verticalLine:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},color:{set:[{name:"dividedBy"}]}},geometry:"line"},pie:{channels:{x:{set:[{name:"angle"},{name:"by"}]},color:{set:[{name:"by"}]},label:{set:[{name:"angle"}]}},coordSystem:"polar"},polarColumn:{channels:{x:{set:[{name:"angle"}]},y:{set:[{name:"radius"}]},label:{set:[{name:"radius"}]}},coordSystem:"polar"},polarStackedColumn:{channels:{x:{set:[{name:"angle"}]},y:{set:[{name:"radius"},{name:"stackedBy"}]},color:{set:[{name:"stackedBy"}]}},coordSystem:"polar"},variableRadiusPie:{channels:{x:{set:[{name:"angle"},{name:"by"}]},y:{set:[{name:"radius"}]},color:{set:[{name:"by"}]},label:{set:[{name:"radius"}]}},coordSystem:"polar"},radialBar:{channels:{x:{set:[{name:"angle"}]},y:{set:[{name:"radius"}],range:{min:"-50%"}},label:{set:[{name:"angle"}]}},coordSystem:"polar"},radialStackedBar:{channels:{x:{set:[{name:"angle"},{name:"stackedBy"}]},y:{set:[{name:"radius"}],range:{min:"-50%"}},color:{set:[{name:"stackedBy"}]},label:{set:[{name:"angle"}]}},coordSystem:"polar"},donut:{channels:{x:{set:[{name:"angle"},{name:"stackedBy"}]},y:{range:{min:"-200%",max:"100%"}},color:{set:[{name:"stackedBy"}]}},coordSystem:"polar"},nestedDonut:{channels:{x:{set:[{name:"angle"},{name:"stackedBy"}]},y:{set:[{name:"radius"}],range:{min:"-50%"}},color:{set:[{name:"stackedBy"}]},label:{set:[{name:"angle"}]}},coordSystem:"polar",align:"stretch"},polarScatter:{channels:{x:{set:[{name:"angle"}]},y:{set:[{name:"radius"}]},noop:{set:[{name:"dividedBy"}]}},coordSystem:"polar",geometry:"circle"},polarLine:{channels:{x:{set:[{name:"angle"}]},y:{set:[{name:"radius"}]},color:{set:[{name:"dividedBy"}]}},coordSystem:"polar",geometry:"line"},treemap:{channels:{size:{set:[{name:"size"},{name:"color"}]},color:{set:[{name:"color"}]},label:{set:[{name:"color"}]}}},stackedTreemap:{channels:{size:{set:[{name:"size"},{name:"dividedBy"}]},color:{set:[{name:"color"}]},label:{set:[{name:"dividedBy"}]},lightness:{set:[{name:"size"}]}}},heatmap:{channels:{x:{set:[{name:"x"}]},y:{set:[{name:"y"}]},lightness:{set:[{name:"lightness"}]}}},bubble:{channels:{size:{set:[{name:"size"}]},color:{set:[{name:"color"}]},label:{set:[{name:"color"}]}},geometry:"circle"},stackedBubble:{channels:{size:{set:[{name:"size"},{name:"stackedBy"}]},color:{set:[{name:"color"}]}},geometry:"circle"}};class G{constructor(){this.be=q;for(const t in this.be){const e=t;this[e]=t=>this._e(e,t)}}xe(){return{align:"none",coordSystem:"cartesian",orientation:"auto",angle:0,split:!1,geometry:"rectangle",channels:{x:{set:null},y:{set:null},color:{set:null},lightness:{set:null},size:{set:null},noop:{set:null},label:{set:null}}}}Ae(t){const e=o(this.be[t]),s={...this.xe().channels,...e.channels},n=Object.assign(this.xe(),e);return n.channels=s,n}ke(t){return null==t?null:Array.isArray(t)?t:[t]}Se(t,e){if(!e)return;const s=t.channels;for(const t in s){const n=s[t];if(this.Ce(n))if("string"==typeof n.set){const t=n.set;n.set=this.ke(e[t])}else if(Array.isArray(n.set)){const t=[];for(let s=0;s<n.set.length;s++){const r=n.set[s].name,i=this.ke(e[r]);null!==i&&t.push(i)}n.set=t.length>0?t.flat():null}}}Ce(t){return"object"==typeof t&&null!==t&&"set"in t}Ee(t,e,s){const n=e[s];void 0!==n&&(t[s]=n)}Be(t,e){["legend","title","subtitle","caption","reverse","sort"].forEach((s=>{const n=s;this.Ee(t,e,n)}))}_e(t,e){const s=this.Ae(t);return this.Se(s,e),this.Be(s,e),s}}var K,J;!function(t){t.start="start",t.update="update",t.render="render",t.prepareAnimation="prepareAnimation",t.registerAnimation="registerAnimation",t.runAnimation="runAnimation"}(K||(K={})),function(t){t.forced="forced",t.allowed="allowed",t.disabled="disabled"}(J||(J={}));class Y{constructor(t,e){if(this.je=t,this.Pe=[],e){if(!Array.isArray(e))throw new Error("Plugins must be an array");e.forEach((t=>this.register(t,!0)))}}init(t){this.Te=t,this.Pe.forEach((t=>{t.enabled&&this.ze(t)}))}enable(t,e){const s=this.Oe(t);this.De(s,e)}getRegisteredName(t){const e=this.Pe.find((e=>e.instance===t));return e?.name}register(t,e=!0){this.We(t);const s=this.Fe(t);t.register&&this.je&&t.register(this.je);const n={name:s,instance:t,enabled:!e};return this.Pe.push(n),this.De(n,e),s}destruct(){const t=this.Pe.map((t=>t.name));try{t.forEach((t=>this.unregister(t)))}finally{this.Pe=[],this.je=null}}unregister(t){const e=this.Pe.findIndex((e=>e.name===t));if(-1!==e){const t=this.Pe[e];this.Pe.splice(e,1),t?.instance.unregister&&this.je&&t.instance.unregister(this.je)}}api(t){return this.Oe(t).instance.api||{}}hook(t,e){return{default:(s=(()=>{}))=>{this.Ue(e,t,s)}}}De(t,e){t.enabled!==e&&(t.enabled=e,t.instance.enable&&t.instance.enable(e),t.enabled?this.ze(t):this.Ie(t))}ze(t){t.instance.listeners&&(t.registeredListeners=t.instance.listeners,this.Te?.addMany(t.registeredListeners))}Ie(t){t.registeredListeners&&this.Te?.removeMany(t.registeredListeners),delete t.registeredListeners}We(t){this.Me(t),this.Ne(t)}Me(t){const e=this.Fe(t);if(!("string"==typeof e&&e.length>0))throw new Error("Plugin must have a non empty name string")}Fe(t){return t.meta?.name??(t.constructor?.name?this.Re(t.constructor.name):void 0)}Re(t){return"string"==typeof t&&t[0]?t[0].toLowerCase()+t.slice(1):""}Ne(t){if(t.meta?.depends){if(Array.isArray(t.meta.depends)){for(const e of t.meta.depends)this.Oe(e);return}throw new Error("Plugin depends must be an array")}}Oe(t){const e=this.Pe.find((e=>e.name===t));if(e)return e;throw new Error(`Plugin ${t} is not registered`)}Ue(t,e,s){const n=[...this.$e(e),s];this.Le(n,t)}$e(t){return this.Pe.filter((e=>e.enabled&&e.instance.hooks?.[t])).map((e=>e.instance.hooks[t])).sort(((t,e)=>(e.priority||0)-(t.priority||0)))}Le(t,e){const s=n=>{if(n>=t.length)return;const r=t[n],i=()=>s(n+1);r?r(e,i):i()};s(0)}}var Q=Object.freeze({__proto__:null,get Hooks(){return K},PluginRegistry:Y,get RenderControlMode(){return J}});class X{constructor(){this.Gt=()=>{},this.Ve=null,this.de=!0,this.meta={name:"rendering"}}get api(){return{update:(t=null)=>{this.Ve=t,this.Gt(!0)}}}get hooks(){return{start:(t,e)=>{this.Gt=t.update,e()},update:(t,e)=>{null!==this.Ve&&(t.timeInMSecs=this.Ve,this.Ve=null),e()},render:(t,e)=>{t.control===J.disabled&&this.de&&(t.control=J.allowed),e()}}}enable(t){this.de=t}}class Z{constructor(){this.Gt=()=>{},this.de=!1,this.meta={name:"scheduler"}}get hooks(){return{start:(t,e)=>{this.Gt=t.update,this.He(),e()}}}enable(t){this.de=t,this.de?this.He():this.qe()}unregister(){this.qe()}He(){this.Ge||(this.Gt(!1),this.Ge=setInterval((()=>{this.de&&this.Gt(!1)}),25))}qe(){this.Ge&&clearInterval(this.Ge),delete this.Ge}}class tt{constructor(t){return new Proxy(this,{get:(e,s)=>t.getValue(s)})}}class et{constructor(t){this.Ke=t}set(t){if(t){if(t.series){if(!Array.isArray(t.series))throw new Error("data series field is not an array");for(const e of t.series)this.Je(e)}if("records"in t){if(!Array.isArray(t.records))throw new Error("data records field is not an array");const e=this.Ke.getMetaInfo().series;for(const s of t.records)this.Ye(s,e)}(t.filter||null===t.filter)&&this.Qe(t.filter)}}Ye(t,e){if(!Array.isArray(t)){if("object"!=typeof t||null===t)throw new Error("data record is not an array or object");t=this.Xe(t,e)}this.Ke.addRecord(t)}Xe(t,e){const s=[];return e.forEach((e=>{e.name in t?s.push(t[e.name]||this.Ze(e.type)):s.push(this.Ze(e.type))})),s}Ze(t){return"measure"===t?0:""}Je(t){if(!t.name)throw new Error("missing series name");if(this.ts(t))this.es(t),this.ss(t.name,t.values??[],t.categories);else{const e=t?.values??[],s=t?.type??this.ns(e);if("dimension"===s){const{indexes:s,categories:n}=this.rs(e);this.ss(t.name,s,n)}else{if(!this.os(t,s))throw new Error("invalid series type: "+t.type);t.unit||(t.unit=""),this.hs(t.name,t.unit,e)}}}ts(t){return!(!("categories"in t)||!Array.isArray(t.categories))}os(t,e){return"measure"===e||"unit"in t&&"string"==typeof t.unit}es(t){if(t.values&&Array.isArray(t.values)){const e=t.categories.length;for(const s of t.values){if(null===s)continue;const t=Number(s);if(!Number.isInteger(t))throw new Error("invalid category value (not an int): "+t);if(t<0)throw new Error("invalid category value (negative): "+t);if(t>=e)throw new Error("invalid category value (out of range): "+t)}}if(new Set(t.categories).size!==t.categories.length)throw new Error("duplicate category values")}ns(t){if(Array.isArray(t)&&t.length){if("number"==typeof t[0]||null===t[0])return"measure";if("string"==typeof t[0])return"dimension"}return null}ss(t,e,s){if("string"!=typeof t)throw new Error("first parameter should be string");if(!(e instanceof Array))throw new Error("second parameter should be an array");if(!(s instanceof Array))throw new Error("third parameter should be an array");if(!this.ls(s))throw new Error("third parameter should be an array of strings");if(!this.cs(e))throw new Error("the measure index array element should be number");this.Ke.addDimension(t,e,s)}ls(t){for(const e of t)if("string"!=typeof e)return!1;return!0}cs(t){for(const e of t){const t=Number(e);if(!Number.isInteger(t)||t<0)return!1}return!0}rs(t){const e=new Map,s=[],n=new Array(t.length);for(let r=0;r<t.length;r++){const i=t[r];if("string"!=typeof i)continue;let a=e.get(i);void 0===a&&(a=s.length,e.set(i,a),s.push(i)),n[r]=a}return{categories:s,indexes:n}}hs(t,e,s){if("string"!=typeof t)throw new Error("'name' parameter should be string");if("string"!=typeof e)throw new Error("'unit' parameter should be string");if(!(s instanceof Array))throw new Error("'values' parameter should be an array");const n=s.map((t=>Number(t)));this.Ke.addMeasure(t,e,n)}Qe(t){if("function"==typeof t){const e=e=>t(new tt(e));this.Ke.setFilter(e)}else{if(null!==t)throw new Error("data filter is not a function or null");this.Ke.setFilter(null)}}}class st{constructor(t){this.us=t}store(){return this.us.storeAnim()}seek(t){const e="string"!=typeof t?t.toString():t;return this.ds("seek",e),this}set speed(t){const e="string"!=typeof t?t.toString():t;this.ds("speed",e)}get speed(){return Number(this.fs("speed"))}set playState(t){this.ds("playState",t)}get playState(){return this.fs("playState")}set direction(t){this.ds("direction",t)}get direction(){return this.fs("direction")}set position(t){const e="string"!=typeof t?t.toString():t;this.ds("position",e)}get position(){return this.fs("position")}pause(){return this.playState="paused",this}play(){return this.playState="running",this}stop(){return this.ds("stop"),this}cancel(){return this.ds("cancel"),this}reverse(){return this.direction="reverse"===this.direction?"normal":"reverse",this}ds(t,e=""){this.us.setParam(t,e)}fs(t){return this.us.getParam(t)}}class nt{constructor(){this.meta={name:"shorthands"}}get hooks(){return{prepareAnimation:Object.assign(((t,e)=>{this.ys(t),e()}),{priority:1})}}register(t){this.Ut=t,this.ps=Object.keys(this.Ut.config.channels)}ys(t){if(!(t.target instanceof n)){const e=this.gs(t.target,t.options);void 0===t.options||this.ws(t.target)||delete t.options,t.target=e}const e=this.vs(t.options);e&&(t.options=e)}gs(t,e){return(this.ws(t)?t:[this.bs(t,e)]).map((t=>this._s(t)?t:{target:t})).map((t=>this.xs(t)))}bs(t,e){return Object.assign({target:t},void 0!==e?{options:e}:{})}ws(t){return Array.isArray(t)}_s(t){return"target"in t}xs(t){const e=this.vs(t.options);return Object.assign({target:this.As(t.target)},e?{options:e}:{})}As(t){if(t&&!(t instanceof d)){if(this.ks(t))return{config:this.Ss(t)};void 0!==t.config&&(t.config=this.Ss(t.config)),void 0!==t.style&&(t.style=this.Cs(t.style))}return t}Cs(t){return null===t?{"":null}:void 0===t?{}:t}Es(t){return"data"in t||"style"in t||"config"in t}ks(t){return!this.Es(t)}Ss(t){const{channels:e,...s}=this.Bs(t);return{...s,...e?{channels:this.js(e)}:{}}}Bs(t){if(null!==t&&"object"==typeof t){t.channels=t.channels||{};for(const e in t){const s=e;if(this.Ps(s)){const e=t[s];void 0!==e&&(t.channels[s]=e),delete t[s]}}}return t}Ps(t){return this.ps.includes(t)}js(t){const e={};for(const s in t){const n=s,r=t[n];void 0!==r&&(e[n]=this.Ts(r))}return e}Ts(t){if("string"==typeof t&&(t=[t]),this.zs(t)?t={set:this.Os(t)}:void 0!==t.set&&this.zs(t.set)&&(t.set=this.Os(t.set)),void 0!==t.attach&&this.zs(t.attach)){const e=this.Os(t.attach);null!==e?t.attach=e:delete t.attach}if(void 0!==t.detach&&this.zs(t.detach)){const e=this.Os(t.detach);null!==e?t.detach=e:delete t.detach}return t}zs(t){return null===t||"string"==typeof t||Array.isArray(t)||"object"==typeof t&&"name"in t}Os(t){return null===t?null:Array.isArray(t)?0===t.length?null:t.map((t=>this.Ds(t))):"string"==typeof t?[this.Ds(t)]:"object"==typeof t&&"name"in t?[t]:null}Ds(t){if("string"==typeof t){const e=/^(\w+)\((.*?)\)$/,s=t.match(e);return s?{name:s[2],aggregator:s[1]}:{name:t}}return t}vs(t){return void 0!==t&&(null===t?t={duration:0}:"string"!=typeof t&&"number"!=typeof t||(t={duration:t})),t}}class rt{constructor(){this.Ws=0,this.Fs=!1,this.Us=null,this.Is=null,this.Ms=(new Date).getTime(),this.meta={name:"tooltip",depends:["pointerEvents"]},this.listeners={pointermove:this.Ns.bind(this),pointerleave:this.Rs.bind(this)}}get hooks(){return{prepareAnimation:(t,e)=>{Array.isArray(t.target)&&t.target.forEach((({target:t})=>{t instanceof d||(t.config||(t.config={}),"tooltip"in t.config||(t.config.tooltip=null,this.Ws++,this.Us=null))})),e()}}}register(t){this.ye=t}enable(t){t||null===this.Us||(this.Ws++,setTimeout((()=>{this.$s(this.Ws)}),200))}Ns(t){this.Ms=(new Date).getTime();const e=this.Ls(t.target);e!==this.Is&&(this.Is=e,this.Vs(t))}Rs(t){this.Ms=(new Date).getTime(),this.Is=null,this.Vs(t)}Vs(t){this.Ws++;const e=this.Ws,s=this.Ls(t.target);null!==s?setTimeout((()=>{this.Hs(e,s)}),0):setTimeout((()=>{this.$s(e)}),200)}Ls(t){return t&&this.qs(t)?t.index:t&&this.Gs(t)?t.parent.index:null}qs(t){return"plot-marker"===t.tagName}Gs(t){return"plot-marker-label"===t.tagName}Hs(t,e){this.Ws===t&&(this.Fs?setTimeout((()=>{this.Hs(t,e)}),100):(this.Us=e,this.Fs=!0,this.ye?.animate([{target:{config:{tooltip:e}},options:{duration:this.Us?"100ms":"250ms"}}]).then((()=>{this.Fs=!1}))))}$s(t){if(this.Ws===t){const e=(new Date).getTime()-this.Ms;!this.Fs&&e>200?(this.Us=null,this.Fs=!0,this.ye?.animate([{target:{config:{tooltip:null}},options:{duration:"250ms"}}]).then((()=>{this.Fs=!1}))):setTimeout((()=>{this.$s(t)}),200-e)}}}class it{constructor(t,e,s){this.Ks=!0,this.Ct=e,this.Pe=s,this.Js=t,this.Mt=this.Js.createChart(),this.Js.registerChart(this.Mt,this),this._t=this.Js.createCanvas(),this.Ke=this.Js.getData(this.Mt),this.Ys=new et(this.Ke),this.Te=new W(this.Mt),this.Pe.init(this.Te)}registerBuiltins(){this.Pe.register(new I(this.Js.setLogging.bind(this.Js)),!1),this.Pe.register(new U(U.extractOptions(this.Ct)),!0),this.Pe.register(new B,!0),this.Pe.register(new j,!0),this.Pe.register(new Z,!0),this.Pe.register(new X,!0),this.Pe.register(new P(this.Js.getCoordSystem(this.Mt)),!0),this.Pe.register(new O,!1),this.Pe.register(new nt,!0),this.Pe.register(new $,!0),this.Pe.register(new H(this.Mt),!0),this.Pe.register(new rt,!1)}detach(){this.Js.unregisterChart(this.Mt)}start(){const t={update:t=>this.updateAndRender(t)};this.Pe.hook(K.start,t).default((()=>{this.updateAndRender()}))}updateAndRender(t=!1){this.Gt(),this.Qs(t)}Gt(){this.Pe.hook(K.update,{timeInMSecs:null}).default((t=>{t.timeInMSecs&&this.Mt.update(t.timeInMSecs)}))}Qs(t){const e={renderer:null,control:t?J.forced:J.disabled,changed:this.Ks,size:{x:0,y:0}};this.Pe.hook(K.render,e).default((t=>{if(t.size.x<1||t.size.y<1||!t.renderer)return;(t.control===J.forced||t.control===J.allowed&&t.changed)&&(t.renderer.canvas=this._t,this.Js.registerRenderer(this._t,t.renderer),this.Mt.render(this._t,t.size.x,t.size.y),this.Js.unregisterRenderer(this._t),this.Ks=!1)}))}doChange(){this.Ks=!0}openUrl(t){window.open(this.Mt.getString(t),"_blank")}async prepareAnimation(t,e){const s=Object.assign({target:t},void 0!==e?{options:e}:{});await this.Pe.hook(K.prepareAnimation,s).default((t=>{this.setAnimParams(t.target,t.options)}))}runAnimation(t){const e={callback:t};this.Pe.hook(K.runAnimation,e).default((t=>{this.Mt.animate(t.callback)}))}setAnimParams(t,e){if(t instanceof n)this.Mt.restoreAnim(t);else for(const e of t)this.Xs(e.target,e.options);e&&this.Mt.animOptions.set(e)}Xs(t,e){t&&(t instanceof d?this.Mt.restoreSnapshot(t):(t.data&&this.Ys.set(t.data),t.style&&this.Mt.style.set(t.style),t.config&&(this.Zs(t.config),this.Mt.config.set(t.config)))),e&&this.Mt.animOptions.set(e),this.Mt.setKeyframe()}Zs(t){t.channels&&Object.values(t.channels).forEach((t=>{Array.isArray(t?.set)&&0===t?.set.length&&(t.set=null)}))}version(){return this.Js.version()}get data(){return this.Ke.getMetaInfo()}get config(){return this.Mt.config.get()}get style(){return this.Mt.style.get()}getComputedStyle(){return this.Mt.computedStyle.get()}on(t,e){this.Te.add(t,e)}off(t,e){this.Te.remove(t,e)}store(){return this.Mt.storeSnapshot()}getAnimControl(){return new st(this.tn())}tn(){return this.Js.getAnimControl(this.Mt)}}class at{static get presets(){return new G}static options(t){C.options=t}static initialize(){return C.initialize().then((()=>{}))}constructor(t,e){this.Pe=new Y(this,this.en(t)),this.initializing=C.initialize().then((e=>(this.Ut=new it(e,t,this.Pe),this.Ut.registerBuiltins(),this.Ut.start(),this))),this.sn=this.initializing,e&&(this.initializing=this.animate([{target:e,options:{duration:0}}]).then((()=>this)))}en(t){return"object"==typeof t&&null!==t&&"features"in t?t.features:[]}get feature(){const t=this.nn.bind(this);return new Proxy(t,{get:(t,e)=>this.Pe.api(e)})}nn(t,e){if(void 0!==e&&"boolean"!=typeof e)throw new Error("enabled parameter must be boolean if specified");let s,n=!1;if("string"!=typeof t){const r=t;s=this.Pe.getRegisteredName(r),s||(s=this.Pe.register(r,e??!0),n=!0)}else s=t;return void 0!==e&&!n&&this.Pe.enable(s,e),this.Pe.api(s)}animate(t,e){const n=o(t,s),r=o(e),i=Object.assign({target:n,promise:this.sn},void 0!==r?{options:r}:{});return this.Pe.hook(K.registerAnimation,i).default((t=>{let e=()=>{};const s=new Promise((t=>{e=t})),i=t.promise.then((()=>this.rn(n,r,e)));t.promise=Object.assign(i,{activated:s})})),this.sn=i.promise,this.sn}rn(t,e,s){if(!this.Ut)throw new V;return this.Ut.prepareAnimation(t,e).then((()=>this.an(s)))}an(t){return new Promise(((e,s)=>{if(!this.Ut)throw new V;this.Ut.runAnimation((t=>{t?e(this):(s(new L),this.sn=Promise.resolve(this))})),t(this.Ut.getAnimControl())}))}get animation(){if(!this.Ut)throw new V;return this.Ut.getAnimControl()}version(){if(!this.Ut)throw new V;return this.Ut.version()}get data(){if(!this.Ut)throw new V;return this.Ut.data}get config(){if(!this.Ut)throw new V;return this.Ut.config}get style(){if(!this.Ut)throw new V;return this.Ut.style}getComputedStyle(){if(!this.Ut)throw new V;return this.Ut.getComputedStyle()}on(t,e){if(!this.Ut)throw new V;this.Ut.on(t,e)}off(t,e){if(!this.Ut)throw new V;this.Ut.off(t,e)}store(){if(!this.Ut)throw new V;return this.Ut.store()}detach(){try{this.Pe.destruct(),this.Ut?.detach()}catch(t){console.error(`Error during plugin destruct: ${t}`)}}}var ot=Object.freeze({__proto__:null}),ht=Object.freeze({__proto__:null}),lt=Object.freeze({__proto__:null}),ct=Object.freeze({__proto__:null}),ut=Object.freeze({__proto__:null}),dt=Object.freeze({__proto__:null});export{ot as Anim,st as AnimControl,r as CAnimControl,n as CAnimation,a as CCanvas,g as CChart,i as CColorGradient,w as CCoordSystem,b as CData,e as CEnv,t as CError,m as CEvent,s as CObject,u as CProxy,v as CRecord,_ as CRenderer,O as CSSProperties,L as CancelError,E as CanvasError,B as CanvasRenderer,it as Chart,j as Clock,ht as Config,P as CoordSystem,lt as Data,tt as DataRecord,F as Events,dt as Geom,U as HtmlCanvas,I as Logging,A as Module,V as NotInitializedError,x as ObjectRegistry,$ as PivotData,Q as Plugins,H as PointerEvents,ct as Presets,X as RenderControl,Z as Scheduler,nt as Shorthands,d as Snapshot,ut as Styles,rt as Tooltip,at as Vizzu,at as default,C as loader};
